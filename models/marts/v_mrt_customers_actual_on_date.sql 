
SELECT first_name, last_name, email
FROM (SELECT first_name, last_name, email, effective_from
	  ,coalesce (lead(effective_from) over(partition by customer_pk order by effective_from), '9999-12-31') as effective_to
	  FROM {{ ref('sat_customer_details') }} ) scd   --dbt.sat_customer_details
where '20230326' between effective_from and effective_to
order by 1